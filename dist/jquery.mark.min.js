/*!***************************************************
* advanced-mark.js v2.6.0
* https://github.com/angezid/advanced-mark.js
* MIT licensed
* Copyright (c) 2022–2024, angezid
* Based on 'mark.js', license https://git.io/vwTVl
*****************************************************/
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],e):(t="undefined"!=typeof globalThis?globalThis:t||self).Mark=e(t.jQuery)}(this,(function(t){"use strict";function e(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var n=e(t);function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(o=r.key,a=void 0,"symbol"==typeof(a=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"))?a:String(a)),r)}var o,a}function i(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function s(){return s=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},s.apply(this,arguments)}var c=function(){function t(e,n){o(this,t),this.ctx=e,this.opt=n,this.map=new Map}return i(t,[{key:"getContexts",value:function(){var t=this.ctx,e=this.opt.window,n=!1;if(!t)return[];Array.isArray(t)?n=!0:t="string"==typeof t?Array.from(e.document.querySelectorAll(t)):t.length>=0?Array.from(t):[t];var r=[];return t.forEach((function(t){-1!==r.indexOf(t)||r.some((function(e){return e.contains(t)}))||r.push(t)})),n&&r.sort((function(t,n){return(t.compareDocumentPosition(n)&e.Node.DOCUMENT_POSITION_FOLLOWING)>0?-1:1})),r}},{key:"getIframeContents",value:function(t,e,n){try{var r=t.contentWindow.document;r&&(this.map.set(t,"ready"),e({iframe:t,context:r}))}catch(e){n({iframe:t,error:e})}}},{key:"observeIframeLoad",value:function(t,e,n){var r=this;if(!this.map.has(t)){var o=null,a=function a(){clearTimeout(o),t.removeEventListener("load",a),r.getIframeContents(t,e,n)};t.addEventListener("load",a),this.map.set(t,!0),o=setTimeout(a,this.opt.iframesTimeout)}}},{key:"onIframeReady",value:function(t,e,n){try{var r="about:blank",o=t.getAttribute("src"),a=t.contentWindow;"complete"===a.document.readyState?o&&o.trim()!==r&&a.location.href===r?this.observeIframeLoad(t,e,n):this.getIframeContents(t,e,n):this.observeIframeLoad(t,e,n)}catch(t){n(t)}}},{key:"waitForIframes",value:function(t,e){var n,r,o=this,a=this.opt.shadowDOM,i=0,s=0,c=function t(e){for(var i=o.createIterator(e,o.opt.window.NodeFilter.SHOW_ELEMENT);r=i.nextNode();)o.isIframe(r)&&!o.map.has(r)&&(n.push(r),s++),a&&r.shadowRoot&&"open"===r.shadowRoot.mode&&t(r.shadowRoot)};!function t(r){n=[],r.iframe&&"about:blank"===r.context.location.href||(c(r.context),r.iframe||n.length)?n.length?n.forEach((function(n){o.onIframeReady(n,(function(e){i++,t(e)}),(function(t){o.opt.debug&&console.log(t.error||t),++i===s&&e()}))})):i===s&&e():e()}({context:t})}},{key:"createIterator",value:function(t,e){var n=this.opt.window;return n.document.createNodeIterator(t,e,(function(){return n.NodeFilter.FILTER_ACCEPT}),!1)}},{key:"addRemoveStyle",value:function(t,e,n){if(!n||e){var r=t.querySelector("style[data-markjs]");n?(r||((r=this.opt.window.document.createElement("style")).setAttribute("data-markjs","true"),t.appendChild(r)),r.textContent=e):r&&t.removeChild(r)}}},{key:"isIframe",value:function(e){return"IFRAME"===e.tagName&&!t.matches(e,this.opt.exclude)}},{key:"iterateThroughNodes",value:function(t,e,n,r,o){var a=this,i=this.opt.window.NodeFilter,s=this.opt.shadowDOM,c=this.opt.iframes;if(c||s){var u=(e&i.SHOW_ELEMENT)>0,l=(e&i.SHOW_TEXT)>0;!function t(o){for(var f,h=a.createIterator(o,e|i.SHOW_ELEMENT);o=h.nextNode();)if(1===o.nodeType){if(u&&n(o)&&r(o),c&&a.isIframe(o)&&"ready"===a.map.get(o)){var d=o.contentWindow.document;d&&t(d)}s&&(f=o.shadowRoot)&&"open"===f.mode&&(a.addRemoveStyle(f,s.style,l),t(f))}else l&&3===o.nodeType&&n(o)&&r(o)}(t)}else for(var f,h=this.createIterator(t,e);f=h.nextNode();)n(f)&&r(f);o()}},{key:"forEachNode",value:function(t,e,n){var r=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},a=this.getContexts(),i=a.length;i||o();var s=function(){a.forEach((function(a){r.iterateThroughNodes(a,t,n,e,(function(){--i<=0&&o()}))}))};if(this.opt.iframes){var c=i,u=!1,l=setTimeout((function(){u=!0,s()}),this.opt.iframesTimeout);a.forEach((function(t){r.waitForIframes(t,(function(){--c<=0&&(clearTimeout(l),u||s())}))}))}else s()}}],[{key:"matches",value:function(t,e){if(!e||!e.length)return!1;var n="string"==typeof e?[e]:e,r=t.matches||t.matchesSelector||t.msMatchesSelector||t.mozMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector;return r&&n.some((function(e){return r.call(t,e)}))}}]),t}(),u=function(){function t(e){o(this,t),this.opt=s({},{diacritics:!0,accuracy:"partially",caseSensitive:!1,ignoreJoiners:!1,ignorePunctuation:[],wildcards:"disabled"},e)}return i(t,[{key:"chars",get:function(){var t=this;return this._chars||(this._chars=[],["aàáảãạăằắẳẵặâầấẩẫậäåāą","cçćč","dđď","eèéẻẽẹêềếểễệëěēę","iìíỉĩịîïī","lł","nñňń","oòóỏõọôồốổỗộơởỡớờợöøōő","rř","sšśșş","tťțţ","uùúủũụưừứửữựûüůūű","yýỳỷỹỵÿ","zžżź"].forEach((function(e){t._chars.push(e,e.toUpperCase())}))),this._chars}},{key:"create",value:function(t){var e=this,n=[],r=0;t=t.map((function(t){return e.opt.charSets&&(t=t.replace(/(\\.)+|\[(?:[^\\\]]|(?:\\.))+\](?:[+*?]\??|\{[\d,]+\}\??)?/g,(function(t,e){return e?t:(n.push(t),""+r+++"")})).replace(/\\+(?=\[|\x03)/g,(function(t){return t.slice(1)}))),"("+e.createPattern(t)+")"}));var o=this.createAccuracy(t.join("|"));return n.length&&(o.pattern=o.pattern.replace(/\x03(\d+)\x03/g,(function(t,e){return n[e]}))),new RegExp("".concat(o.lookbehind,"(").concat(o.pattern,")").concat(o.lookahead),"g".concat(this.opt.caseSensitive?"":"i"))}},{key:"createPattern",value:function(t){var e="disabled"!==this.opt.wildcards;t=t.replace(/\s+/g," "),e&&(t=this.createPlaceholders(t)),t=t.replace(/[[\]/{}()*+?.\\^$|]/g,"\\$&");var n=this.getJoinersPunctuation();return n&&(t=this.setupIgnoreJoiners(t)),this.opt.diacritics&&(t=this.createDiacritics(t)),t=t.replace(/ /g,"\\s+"),n&&(t=t.split(/\x00+/).join("[".concat(n,"]*"))),e&&(t=this.createWildcards(t)),t}},{key:"preprocess",value:function(t){return t&&t.length?this.distinct("string"==typeof t?t.split(""):t).join("").replace(/[-^\]\\]/g,"\\$&"):""}},{key:"distinct",value:function(t){var e=[];return t.forEach((function(t){t.trim()&&-1===e.indexOf(t)&&e.push(t)})),e}},{key:"getJoinersPunctuation",value:function(){var t=this.preprocess(this.opt.ignorePunctuation);return this.opt.ignoreJoiners&&(t+="\\u00ad\\u200b\\u200c\\u200d"),t}},{key:"setupIgnoreJoiners",value:function(t){return t.replace(/((?:\\\\)+|\x02|\x03\d+\x03|\|)|\\?(?:[\uD800-\uDBFF][\uDC00-\uDFFF]|.)(?=(\x02|\||$)|.)/g,(function(t,e,n){return e||void 0!==n?t:t+"\0"}))}},{key:"createPlaceholders",value:function(t){return t.replace(/(\\.)+|[?*]/g,(function(t,e){return e?t:"?"===t?"":""})).replace(/\\+(?=[?*\x01\x02])/g,(function(t){return t.slice(1)}))}},{key:"createWildcards",value:function(t){var e="withSpaces"===this.opt.wildcards,n=e&&this.opt.boundary?"[^]*?":"[^]*?";return t.replace(/\x01/g,e?"[^]?":"\\S?").replace(/\x02/g,e?n:"\\S*")}},{key:"createDiacritics",value:function(t){var e=this,n=this.chars;return t.split("").map((function(t){for(var r=0;r<n.length;r+=2){var o=n[r].includes(t);if(e.opt.caseSensitive){if(o)return"["+n[r]+"]";if(n[r+1].includes(t))return"["+n[r+1]+"]"}else if(o||n[r+1].includes(t))return"["+n[r]+n[r+1]+"]"}return t})).join("")}},{key:"createAccuracy",value:function(t){var e,n=this.opt.accuracy,r="()",o=t,a="";if("partially"!==n){"string"!=typeof n&&(e=this.preprocess(n.limiters),n=n.value);var i="(^|[".concat(e="\\s"+(e||"!\"#$%&'()*+,\\-./:;<=>?@[\\]\\\\^_`{|}~¡¿"),"])");if("exactly"===n)r=i,a="(?=$|[".concat(e,"])");else{var s="[^".concat(e,"]*");"complementary"===n?o="".concat(s,"(?:").concat(t,")").concat(s):"startsWith"===n&&(r=i,o="(?:".concat(t.replace(/\\s\+/g,s+"$&"),")").concat(s))}}return{lookbehind:r,pattern:o,lookahead:a}}}]),t}(),l=function(){function t(e){o(this,t),this.ctx=e,this.nodeNames=["script","style","title","head","html"]}return i(t,[{key:"opt",get:function(){return this._opt},set:function(t){if(!(t&&t.window&&t.window.document)&&"undefined"==typeof window)throw new Error("Mark.js: please provide a window object as an option.");var e=t&&t.window||window;this._opt=s({},{window:e,element:"",className:"",exclude:[],iframes:!1,iframesTimeout:5e3,combinePatterns:1/0,separateWordSearch:!0,acrossElements:!1,ignoreGroups:0,each:function(){},noMatch:function(){},filter:function(){return!0},done:function(){},debug:!1,log:e.console},t),this._opt.element||(this._opt.element="mark"),this.filter=e.NodeFilter,this.empty=e.document.createTextNode("")}},{key:"iterator",get:function(){return new c(this.ctx,this.opt)}},{key:"log",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"debug";if(this.opt.debug){var n=this.opt.log;"object"===r(n)&&"function"==typeof n[e]&&n[e]("mark.js: ".concat(t))}}},{key:"report",value:function(t){var e=this;t.forEach((function(t){e.log("".concat(t.text," ").concat(JSON.stringify(t.obj)),t.level||"debug"),t.skip||e.opt.noMatch(t.obj)}))}},{key:"getSeachTerms",value:function(t){var e="string"==typeof t?[t]:t,n=this.opt.separateWordSearch,r=[],o={},a=function(t){t.split(/ +/).forEach((function(t){return i(t)}))},i=function(t){t.trim()&&!r.includes(t)&&(r.push(t),o[t]=0)};return e.forEach((function(t){n?"preserveTerms"===n?t.split(/"("*[^"]+"*)"/).forEach((function(t,e){e%2>0?i(t):a(t)})):a(t):i(t)})),r.sort((function(t,e){return e.length-t.length})),{terms:r,termStats:o}}},{key:"isNumeric",value:function(t){return Number(parseFloat(t))==t}},{key:"checkRanges",value:function(t,e,n,r){var o=this,a="error",i=t.filter((function(t){return!!(o.isNumeric(t.start)&&o.isNumeric(t.length)&&(t.start=parseInt(t.start),t.length=parseInt(t.length),t.start>=n&&t.start<r&&t.length>0))||(e.push({text:"Invalid range: ",obj:t,level:a}),!1)})).sort((function(t,e){return t.start-e.start}));if(this.opt.wrapAllRanges)return i;var s,c=0;return i.filter((function(t){return s=t.start+t.length,t.start>=c?(c=s,!0):(e.push({text:(s<c?"Nest":"Overlapp")+"ing range: ",obj:t,level:a}),!1)}))}},{key:"setType",value:function(t,e){var n=Array.isArray(e.tagNames)&&e.tagNames.length;if(n&&e.tagNames.forEach((function(e){return t[e.toLowerCase()]=2})),!n||e.extend)for(var r in t)t[r]=2;t.br=3}},{key:"getTextNodesAcross",value:function(t){var e,n,r,o=this,a={div:1,p:1,li:1,td:1,tr:1,th:1,ul:1,ol:1,dd:1,dl:1,dt:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,blockquote:1,figcaption:1,figure:1,pre:1,table:1,thead:1,tbody:1,tfoot:1,input:1,img:1,nav:1,details:1,label:1,form:1,select:1,menu:1,br:3,menuitem:1,main:1,section:1,article:1,aside:1,picture:1,output:1,button:1,header:1,footer:1,address:1,area:1,canvas:1,map:1,fieldset:1,textarea:1,track:1,video:1,audio:1,body:1,iframe:1,meter:1,object:1,svg:1},i=[],s=this.opt.blockElementsBoundary,c=s?2:1,u="";s&&(this.setType(a,s),s.char&&(u=s.char.charAt(0)));var l={text:"",regex:/\s/,tags:a,boundary:s,str:"",ch:u};this.iterator.forEachNode(this.filter.SHOW_ELEMENT|this.filter.SHOW_TEXT,(function(t){r&&i.push(o.getNodeInfo(r,t,n,l)),n=null,r=t}),(function(t){return 1===t.nodeType?(3===(e=a[t.nodeName.toLowerCase()])&&(l.str+="\n"),n&&e!==c||(n=e),!1):!o.excluded(t.parentNode)}),(function(){r&&i.push(o.getNodeInfo(r,null,n,l)),t({text:l.text,nodes:i,lastIndex:0})}))}},{key:"getNodeInfo",value:function(t,e,n,r){var o=r.text.length,a=r.ch,i=0,s=r.str,c=t.textContent;if(e){var u=r.regex.test(e.textContent[0]),l=u&&r.regex.test(c[c.length-1]);if(r.boundary||!l){var f=n;if(!n)for(var h=t.parentNode;h;){if(n=r.tags[h.nodeName.toLowerCase()]){f=!(h===e.parentNode||h.contains(e));break}h=h.parentNode}f&&(l?2===n&&(s+=l?a:u?" "+a:a+" "):s+=1===n?" ":2===n?" "+a+" ":"")}}return s&&(c+=s,i=s.length,r.str=""),r.text+=c,this.createInfo(t,o,r.text.length-i,i)}},{key:"getRangesTextNodes",value:function(t,e){var n,r=this,o=[],a=/\n/g,i=[0],s=this.filter.SHOW_TEXT|(e?this.filter.SHOW_ELEMENT:0),c="",u=0;this.iterator.forEachNode(s,(function(t){if(e)for(;null!==(n=a.exec(t.textContent));)i.push(u+n.index);c+=t.textContent,o.push({start:u,end:u=c.length,offset:0,node:t})}),(function(t){return e&&1===t.nodeType?("br"===t.tagName.toLowerCase()&&i.push(u),!1):!r.excluded(t.parentNode)}),(function(){var n={text:c,nodes:o,lastIndex:0};e&&(i.push(u),n.newLines=i),t(n)}))}},{key:"getTextNodes",value:function(t){var e=this,n=[];this.iterator.forEachNode(this.filter.SHOW_TEXT,(function(t){n.push(t)}),(function(t){return!e.excluded(t.parentNode)}),(function(){t({nodes:n,lastIndex:0})}))}},{key:"excluded",value:function(t){return this.nodeNames.includes(t.nodeName.toLowerCase())||c.matches(t,this.opt.exclude)}},{key:"wrapRangeInsert",value:function(t,e,n,r,o,a){var i=r===e.node.textContent.length,s=e.end,c=1,u=r,l=e.node;0!==n?(l=l.splitText(n),u=r-n,c=i?2:3):i&&(c=0);var f=i?this.empty:l.splitText(u),h=this.wrapTextNode(l),d=h.childNodes[0],p=this.createInfo(f,0===c||2===c?s:e.start+r,s,e.offset);if(0===c)return e.node=d,{mark:h,nodeInfo:p,increment:0};var g=this.createInfo(d,1===c?e.start:o,e.start+r,0);return 1===c?t.nodes.splice(a,1,g,p):(2===c?t.nodes.splice(a+1,0,g):t.nodes.splice(a+1,0,g,p),e.end=o,e.offset=0),{mark:h,nodeInfo:p,increment:c<3?1:2}}},{key:"createInfo",value:function(t,e,n,r){return{node:t,start:e,end:n,offset:r}}},{key:"wrapRange",value:function(t,e,n,r){var o,a=n===t.textContent.length,i=n;return 0!==e&&(t=t.splitText(e),i=n-e),o=a?this.empty:t.splitText(i),r(this.wrapTextNode(t)),o}},{key:"wrapTextNode",value:function(t){var e=this.opt.window.document.createElement(this.opt.element);return e.setAttribute("data-markjs","true"),this.opt.className&&e.setAttribute("class",this.opt.className),e.textContent=t.textContent,t.parentNode.replaceChild(e,t),e}},{key:"wrapRangeAcross",value:function(t,e,n,r,o){var a=t.lastIndex,i=!0,s=this.opt.wrapAllRanges;if(s)for(;a>0&&t.nodes[a].start>e;)a--;for(;a<t.nodes.length;a++)if(a+1===t.nodes.length||t.nodes[a+1].start>e){var c=t.nodes[a];if(!r(c.node))break;var u=e-c.start,l=(n>c.end?c.end:n)-c.start;if(u>=0&&l>u){if(s){var f=this.wrapRangeInsert(t,c,u,l,e,a);c=f.nodeInfo,o(f.mark,i)}else c.node=this.wrapRange(c.node,u,l,(function(t){o(t,i)})),c.start+=l,t.lastTextIndex=c.start;i=!1}if(!(n>c.end))break;e=c.end+c.offset}t.lastIndex=a}},{key:"wrapGroups",value:function(t,e,n,r,o){for(var a,i,s=0,c=0,u=0,l=!1,f=0;++u<e.length;)(a=e[u])&&(i=e.indices[u][0])>=s&&(f=e.indices[u][1],r(t,a,u)&&(t=this.wrapRange(t,i-c,f-c,(function(t){o(t,u)})),f>s&&(s=f),c=f,l=!0));return l?n.lastIndex=0:0===e[0].length&&this.setLastIndex(n,f),t}},{key:"wrapGroupsAcross",value:function(t,e,n,r,o){for(var a,i,s,c=0,u=0,l=0;++u<e.length;)(a=e[u])&&(i=e.indices[u][0],(this.opt.wrapAllRanges||i>=c)&&(l=e.indices[u][1],s=!1,this.wrapRangeAcross(t,i,l,(function(t){return r(t,a,u)}),(function(t,e){s=!0,o(t,u,e)})),s&&l>c&&(c=l)));0===e[0].length&&this.setLastIndex(n,l)}},{key:"setLastIndex",value:function(t,e){var n=t.lastIndex;t.lastIndex=e>n?e:e>0?n+1:1/0}},{key:"wrapSeparateGroups",value:function(t,e,n,r,o){var a,i,s,c=this,u=this.opt.acrossElements,l=u?"wrapGroupsAcross":"wrapGroups",f={abort:!1},h={execution:f},d=0,p=function(e){for(;null!==(a=t.exec(u?e.text:e.textContent))&&(h.match=a,i=s=!0,e=c[l](e,a,t,(function(t,e,r){return h.matchStart=i,h.groupIndex=r,i=!1,n(t,e,h)}),(function(t,e,n){s&&d++;var o={match:a,matchStart:s,count:d,groupIndex:e};void 0!==n&&(o.groupStart=n),r(t,o),s=!1}))||e,!f.abort););};u?this.getTextNodesAcross((function(t){p(t)})):this.getTextNodes((function(t){t.nodes.every((function(t){return p(t),!f.abort}))})),o(d)}},{key:"wrapMatches",value:function(t,e,n,r,o){var a,i,s=this,c=0===e?0:e+1,u={abort:!1},l={execution:u},f=0;this.getTextNodes((function(e){e.nodes.every((function(e){for(;null!==(a=t.exec(e.textContent));)if(""!==(i=a[c])){if(l.match=a,n(e,i,l)){for(var o=0,h=a.index;++o<c;)a[o]&&(h+=a[o].length);var d=h+i.length;if(e=s.wrapRange(e,h,d,(function(t){r(t,{match:a,count:++f})})),t.lastIndex=0,u.abort)break}}else t.lastIndex++;return!u.abort})),o(f)}))}},{key:"wrapMatchesAcross",value:function(t,e,n,r,o){var a,i,s,c=this,u=0===e?0:e+1,l={abort:!1},f={execution:l},h=0;this.getTextNodesAcross((function(e){for(;null!==(a=t.exec(e.text));)if(""!==(i=a[u])){f.match=a,s=!0;for(var d=0,p=a.index;++d<u;)a[d]&&(p+=a[d].length);if(c.wrapRangeAcross(e,p,p+i.length,(function(t){return f.matchStart=s,s=!1,n(t,i,f)}),(function(t,e){e&&h++,r(t,{match:a,matchStart:e,count:h})})),l.abort)break}else t.lastIndex++;o(h)}))}},{key:"wrapRanges",value:function(t,e,n,r){var o=this,a=this.opt.markLines,i=[],s=[],c="warn",u=0;this.getRangesTextNodes((function(l){var f=a?l.newLines.length:l.text.length,h=o.checkRanges(t,i,a?1:0,f);h.forEach((function(t,r){var h=t.start,d=h+t.length;d>f&&(i.push({text:"Range was limited to: ".concat(f),obj:t,skip:!0,level:c}),d=f),a&&(h=l.newLines[h-1],"\n"===l.text[h]&&h++,d=l.newLines[d-1]);var p=l.text.substring(h,d);p.trim()?o.wrapRangeAcross(l,h,d,(function(n){return e(n,t,p,r)}),(function(e,r){r&&u++,n(e,t,{matchStart:r,count:u})})):(i.push({text:"Skipping whitespace only range: ",obj:t,level:c}),s.push(t))})),o.log("Valid ranges: ".concat(JSON.stringify(h.filter((function(t){return!s.includes(t)}))))),r(u,i)}),a)}},{key:"unwrapMatches",value:function(t){var e=t.parentNode,n=t.firstChild;if(1===t.childNodes.length)if(3===n.nodeType){var r=t.previousSibling,o=t.nextSibling;if(r&&3===r.nodeType)o&&3===o.nodeType?(r.nodeValue+=n.nodeValue+o.nodeValue,e.removeChild(o)):r.nodeValue+=n.nodeValue;else{if(!o||3!==o.nodeType)return void e.replaceChild(t.firstChild,t);o.nodeValue=n.nodeValue+o.nodeValue}e.removeChild(t)}else e.replaceChild(t.firstChild,t);else{if(n){for(var a=this.opt.window.document.createDocumentFragment();t.firstChild;)a.appendChild(t.removeChild(t.firstChild));e.replaceChild(a,t)}else e.removeChild(t);e.normalize()}}},{key:"markRegExp",value:function(t,e){var n=this;this.opt=e;var r=0,o=0,a=this.opt.acrossElements,i=this.opt.separateGroups?"wrapSeparateGroups":a?"wrapMatchesAcross":"wrapMatches";if(!t.global&&!t.sticky){var s=t.toString().split("/");t=new RegExp(t.source,"g"+s[s.length-1]),this.log("RegExp is recompiled - it must have a `g` flag","warn")}this.log('RegExp "'.concat(t,'"')),this[i](t,this.opt.ignoreGroups,(function(t,e,r){return n.opt.filter(t,e,o,r)}),(function(t,e){o=e.count,r++,n.opt.each(t,e)}),(function(e){0===e&&n.opt.noMatch(t),n.opt.done(r,e)}))}},{key:"mark",value:function(t,e){var n=this;this.opt=e;var r=this.getSeachTerms(t),o=r.terms,a=r.termStats;if(o.length){var i,s,c=0,u=0,l=0,f=this.opt.acrossElements,h=f?"wrapMatchesAcross":"wrapMatches",d=this.getRegExps(o);!function t(e){var r=e.regex,o=e.regTerms;n.log("RegExp ".concat(r)),n[h](r,1,(function(t,e,r){return f&&!r.matchStart||(i=n.getCurrentTerm(r.match,o)),s=a[i],n.opt.filter(t,i,l+s,s,r)}),(function(t,e){u++,f&&!e.matchStart||(a[i]+=1),n.opt.each(t,e)}),(function(e){l+=e;var r=o.filter((function(t){return 0===a[t]}));r.length&&n.opt.noMatch(r),++c<d.length?t(d[c]):n.opt.done(u,l,a)}))}(d[0])}else this.opt.done(0,0,a)}},{key:"getCurrentTerm",value:function(t,e){for(var n=t.length;--n>2;)if(t[n])return e[n-3];return" "}},{key:"getRegExps",value:function(t){var e,n=new u(this.opt),r=this.opt.combineBy||this.opt.combinePatterns,o=[],a=10;r===1/0?a=Math.pow(2,31):Number.isInteger(r)&&(e=parseInt(r))>0&&(a=e);for(var i=0;i<t.length;i+=a){var s=t.slice(i,Math.min(i+a,t.length));o.push({regex:n.create(s),regTerms:s})}return o}},{key:"markRanges",value:function(t,e){var n=this;if(this.opt=e,Array.isArray(t)){var r=0;this.wrapRanges(t,(function(t,e,r,o){return n.opt.filter(t,e,r,o)}),(function(t,e,o){r++,n.opt.each(t,e,o)}),(function(t,e){n.report(e),n.opt.done(r,t)}))}else this.report([{text:"markRanges() accept an array of objects: ",obj:t,level:"error"}]),this.opt.done(0,0)}},{key:"unmark",value:function(t){var e=this;this.opt=t;var n=this.opt.element+"[data-markjs]";this.opt.className&&(n+=".".concat(this.opt.className)),this.log('Removal selector "'.concat(n,'"')),this.iterator.forEachNode(this.filter.SHOW_ELEMENT,(function(t){e.unwrapMatches(t)}),(function(t){return c.matches(t,n)&&!e.excluded(t)}),this.opt.done)}}]),t}();return n.default.fn.mark=function(t,e){return new l(this.get()).mark(t,e),this},n.default.fn.markRegExp=function(t,e){return new l(this.get()).markRegExp(t,e),this},n.default.fn.markRanges=function(t,e){return new l(this.get()).markRanges(t,e),this},n.default.fn.unmark=function(t){return new l(this.get()).unmark(t),this},n.default.fn.getVersion=function(){return"2.6.0"},n.default}));
